<Lems>

    <Target component="sim1" />

    <!-- Include core NeuroML2 ComponentType definitions -->
    <Include file="Cells.xml" />
    <Include file="Networks.xml" />
    <Include file="Simulation.xml" />

    <Include file="WilsonCowan.xml" />

    <wilsonCowanCell id="E_DL" tau="1ms" R0="0.1" />
    <wilsonCowanCell id="I_DL" tau="1ms" R0="0.05"/>

    <!--Dummy synapse which emits no current. Used as presynaptic endpoint for analog synaptic connection.-->
    <silentSynapseDL id="silent1DL"/>

    <rateSynapseDL id="rsDLE" />
    <rateSynapseDL id="rsDLI" />

    <sineGeneratorDL id="modEDL" phase="0" delay="0ms" duration="100ms" amplitude="1.4" period="20ms"/>
    <!-- <pulseGeneratorDL id="modEDL" delay="50ms" duration="10ms" amplitude="2" /> 
    <pulseGeneratorDL id="baselineIDL" delay="0ms" duration="100ms" amplitude="8" /> -->

    <network id="net1">
        <population id="ePopDL" component="E_DL" size="1" />
        <population id="iPopDL" component="I_DL" size="1" />

        <continuousProjection id ="w_ee" presynapticPopulation="ePopDL" postsynapticPopulation="ePopDL">
            <continuousConnectionInstanceW id="0" preCell="../ePopDL[0]" postCell="../ePopDL[0]" preComponent="silent1DL" postComponent="rsDLE" weight="10"/>
        </continuousProjection>

        <continuousProjection id ="w_ei" presynapticPopulation="ePopDL" postsynapticPopulation="iPopDL">
            <continuousConnectionInstanceW id="0" preCell="../ePopDL[0]" postCell="../iPopDL[0]" preComponent="silent1DL" postComponent="rsDLI" weight="12"/>
        </continuousProjection>

        <continuousProjection id ="w_ie" presynapticPopulation="iPopDL" postsynapticPopulation="ePopDL">
            <continuousConnectionInstanceW id="0" preCell="../iPopDL[0]" postCell="../ePopDL[0]" preComponent="silent1DL" postComponent="rsDLE" weight="-8"/>
        </continuousProjection>

        <continuousProjection id ="w_ii" presynapticPopulation="iPopDL" postsynapticPopulation="iPopDL">
            <continuousConnectionInstanceW id="0" preCell="../iPopDL[0]" postCell="../iPopDL[0]" preComponent="silent1DL" postComponent="rsDLI" weight="-3"/>
        </continuousProjection>

        <explicitInput target="ePopDL[0]" input="modEDL" destination="synapses"/>
        <!--<explicitInput target="iPopDL[0]" input="rsDLI" destination="synapses"/>-->

    </network>

    <!-- End of NeuroML2 content -->


    <Simulation id="sim1" length="100ms" step="0.005ms" target="net1">

        <Display id="d1" title="iSyn" timeScale="1s" xmin="-5" xmax="105" ymin="-1" ymax="32">
            <Line id="iSyn_e" quantity="ePopDL[0]/iSyn" scale="1" color="#ff8888" timeScale="1ms" />
            <Line id="f_e"    quantity="ePopDL[0]/f" scale="1" color="#ff0000" timeScale="1ms" />
            <Line id="iSyn_i" quantity="iPopDL[0]/iSyn" scale="1" color="#8888ff" timeScale="1ms" />
            <Line id="f_i"    quantity="iPopDL[0]/f" scale="1" color="#0000ff" timeScale="1ms" />
        </Display>

        <Display id="d2" title="Rates" timeScale="1s" xmin="-5" xmax="105" ymin="-0.1" ymax="1.2">
            <Line id="r_e" quantity="ePopDL[0]/R" scale="1" color="#ff0000" timeScale="1ms" />
            <Line id="r_i" quantity="iPopDL[0]/R" scale="1" color="#8888ff" timeScale="1ms" />
        </Display>
    </Simulation>


</Lems>
